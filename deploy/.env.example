# Power Manage Server Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# Database
# =============================================================================
# Strong password for PostgreSQL (generate with: openssl rand -base64 32)
POSTGRES_PASSWORD=CHANGE_ME_generate_a_strong_password

# =============================================================================
# Authentication
# =============================================================================
# JWT secret for session tokens (minimum 32 characters)
# Generate with: openssl rand -base64 48
JWT_SECRET=CHANGE_ME_generate_a_strong_secret_min_32_chars

# Initial admin account (created on first startup)
ADMIN_EMAIL=admin@example.com
ADMIN_PASSWORD=CHANGE_ME_use_a_strong_password

# =============================================================================
# Domain Configuration
# =============================================================================
# Public domain for the control server (Web UI and API)
CONTROL_DOMAIN=power-manage.example.com

# Public domain for the gateway (Agent connections)
GATEWAY_DOMAIN=gateway.example.com

# =============================================================================
# TLS / Let's Encrypt
# =============================================================================
# Email address for Let's Encrypt certificate notifications
ACME_EMAIL=admin@example.com

# =============================================================================
# Logging
# =============================================================================
# Log level: debug, info, warn, error
LOG_LEVEL=info

# =============================================================================
# CORS Configuration (Required for cross-origin web app)
# =============================================================================
# If your web app is hosted on a different domain than the API,
# you MUST set this to allow cross-origin cookies.
# Comma-separated list of allowed origins (include the protocol)
# Example: CORS_ORIGINS=https://app.example.com,https://admin.example.com
CORS_ORIGINS=

# =============================================================================
# Encryption
# =============================================================================
# AES-256 key for encrypting secrets at rest (LUKS keys, LPS passwords, etc.)
# Must be exactly 64 hex characters (32 bytes). Generate with:
#   openssl rand -hex 32
# If not set, secrets are stored unencrypted (a warning is logged on startup).
# WARNING: Changing this key after data has been encrypted will make existing
# encrypted secrets unrecoverable.
PM_ENCRYPTION_KEY=

# =============================================================================
# Optional
# =============================================================================
# Tag for control and gateway images (default: latest)
# IMAGE_TAG=latest

# Log format: text (default, human-readable) or json (structured, for log aggregators)
# LOG_FORMAT=text

# Interval for evaluating dynamic device groups (default: 1h)
# Minimum: 30m, Maximum: 8h, set to 0 to disable
# DYNAMIC_GROUP_EVAL_INTERVAL=1h